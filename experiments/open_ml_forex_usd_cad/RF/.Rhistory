source('~/Desktop/marko_paper/github_code/allign_plots.R')
setwd("~/Desktop/marko_paper/github_code")
source('~/Desktop/marko_paper/github_code/allign_plots.R')
source('~/Desktop/marko_paper/github_code/prepare_data.R')
source('~/Desktop/marko_paper/github_code/solo_hospitals.R')
source('~/Desktop/marko_paper/github_code/solo_hospitals.R')
source('~/Desktop/marko_paper/github_code/global_benchmarka.R')
source('~/Desktop/marko_paper/github_code/run_experiment_variable_size_reference.R')
i
i = 3500
candidates = c(
2,10,20,35,50, 75, 100,
200,  300,  400,  600,  1000,
1500, 2000,
3000,  3500
)
input_p = i
message("Trying : ",input_p)
source("reference_data_hospitals_no_embedding.R") ## input P sent to the script --> ugly code
results[[length(results)+1]] = output_stats
names(results) = paste0("ref_size_",candidates)
saveRDS(results,file = "RDS/ANN_variable_reference_size_all_reference.RDS")
source('~/Desktop/marko_paper/github_code/allign_plots.R')
i = 150
input_p = i
message("Trying : ",input_p)
source("reference_data_hospitals_no_embedding.R") ## input P sent to the script --> ugly code
source('~/Desktop/marko_paper/github_code/run_experiment_variable_size_reference.R')
source('~/Desktop/marko_paper/github_code/global_benchmarka.R')
source('~/Desktop/marko_paper/github_code/run_experiment_variable_size_reference.R')
source('~/Desktop/marko_paper/github_code/run_experiment_variable_size_reference.R')
results
i
a <- readRDS("~/Desktop/marko_paper/github_code/RDS/ANN_variable_reference_size_all_reference.RDS")
b = results
append(b,tail(a,7))
results = append(b,tail(a,7))
names(results) = paste0("ref_size_",candidates)
saveRDS(results,file = "RDS/ANN_variable_reference_size_all_reference.RDS")
source('~/Desktop/marko_paper/github_code/allign_plots.R')
source('~/Desktop/marko_paper/github_code/run_experiment_variable_size_reference.R')
source('~/Desktop/marko_paper/github_code/run_experiment_variable_size_reference.R')
source('~/Desktop/marko_paper/github_code/allign_plots.R')
risi()
risi()[[1]]
source('~/Desktop/marko_paper/github_code/allign_plots.R')
risi()
library(ggplot2)
library(magrittr)
library(reshape2)
library(grid)
global = readRDS("RDS/global_ANN.RDS")
rf = readRDS("RDS/ANN_method.RDS")
rf_ = lapply(rf,function(x){
x$acc = (x$acc %>% TTR::SMA(.,n=2)) %>% max(.,na.rm = T)
x$auc = (x$auc %>% TTR::SMA(.,n=2))  %>% max(.,na.rm = T)
x
})
solo_acc = lapply(rf,function(x){
x$acc[1]
}) %>% unlist() %>% mean()
solo_auc = lapply(rf,function(x){
x$auc[1]
}) %>% unlist() %>% mean()
acc_ = lapply(rf_,function(x)x$acc) %>% unlist()
auc_ = lapply(rf_,function(x)x$auc) %>% unlist()
benchmark_acc = list(
solo = rep(solo_acc,length(acc_)),
global = rep(mean(global$acc),length(acc_)),
ref = acc_,
x = gsub(names(acc_),pattern = "ref_size_",replacement = "") %>% as.numeric()
)
benchmark_auc = list(
solo = rep(solo_auc,length(acc_)),
global = rep(mean(global$auc),length(acc_)),
ref = auc_,
x = gsub(names(auc_),pattern = "ref_size_",replacement = "") %>% as.numeric()
)
acc = stringi::stri_list2matrix(benchmark_acc)
acc = apply(acc,2,as.numeric)
auc = stringi::stri_list2matrix(benchmark_auc)
auc = apply(auc,2,as.numeric)
acc = as.data.frame(acc)
auc = as.data.frame(auc)
colnames(acc) = c(
"solo",
"global",
"proposed method",
"Size"
)
colnames(auc) = c(
"solo",
"global",
"proposed method",
"Size"
)
risi = function(acc11=acc,auc11=auc){
# names = c(names,"Size")
tmp1 = melt(acc11,"Size")
tmp2 = melt(auc11,"Size")
one =  ggplot(tmp1, aes(Size,value)) + geom_point(aes(colour = variable),lwd=1.25) +
geom_line(aes(x=Size,y=value,colour = variable),lwd=0.75) +
xlab("Ref. Size") + ylab("Accuracy (test)") + ggtitle("ANN 16 units : 20 hospitals (from 70-130 examples per hosp.)") +
theme(axis.text.x = element_text(angle = 45)) +
scale_x_log10("Ref. Size", labels = as.character(acc11$Size), breaks = acc11$Size)
two = ggplot(tmp2, aes(Size,value)) + geom_point(aes(colour = variable),lwd=1.25) +
geom_line(aes(x=Size,y=value,colour = variable),lwd=0.75) +
xlab("Ref. Size") + ylab("AUC (test)") + ggtitle("ANN 16 units: 20 hospitals (from 70-130 examples per hosp.)") +
theme(axis.text.x = element_text(angle = 45)) +
scale_x_log10("Ref. Size", labels = as.character(acc11$Size), breaks = acc11$Size)
tmp11 = melt(acc11[,-2],"Size")
tmp22 = melt(auc11[,-2],"Size")
three =  ggplot(tmp11, aes(Size,value)) + geom_point(aes(colour = variable),lwd=1.25) +
geom_line(aes(x=Size,y=value,colour = variable),lwd=0.75) +
xlab("Ref. Size") + ylab("Accuracy (test)") + ggtitle("") +
theme(axis.text.x = element_text(angle = 45)) +
scale_x_log10("Ref. Size", labels = as.character(acc11$Size), breaks = acc11$Size)
four = ggplot(tmp22, aes(Size,value)) + geom_point(aes(colour = variable),lwd=1.25) +
geom_line(aes(x=Size,y=value,colour = variable),lwd=0.75) +
xlab("Ref. Size") + ylab("AUC (test)") + ggtitle("") +
theme(axis.text.x = element_text(angle = 45)) +
scale_x_log10("Ref. Size", labels = as.character(acc11$Size), breaks = acc11$Size)
multiplot = function(..., plotlist=NULL, file, cols=1, layout=NULL) {
# Make a list from the ... arguments and plotlist
plots <- c(list(...), plotlist)
numPlots = length(plots)
# If layout is NULL, then use 'cols' to determine layout
if (is.null(layout)) {
# Make the panel
# ncol: Number of columns of plots
# nrow: Number of rows needed, calculated from # of cols
layout <- matrix(seq(1, cols * ceiling(numPlots/cols)),
ncol = cols, nrow = ceiling(numPlots/cols))
}
if (numPlots==1) {
print(plots[[1]])
} else {
# Set up the page
grid.newpage()
pushViewport(viewport(layout = grid.layout(nrow(layout), ncol(layout))))
# Make each plot, in the correct location
for (i in 1:numPlots) {
# Get the i,j matrix positions of the regions that contain this subplot
matchidx <- as.data.frame(which(layout == i, arr.ind = TRUE))
print(plots[[i]], vp = viewport(layout.pos.row = matchidx$row,
layout.pos.col = matchidx$col))
}
}
}
multiplot(
one,two,three,four,cols=2
)
}
risi()
source('~/Desktop/marko_paper/github_code/FederatedLearningViaCoTraining/experiments/open_ml_forex_usd_cad/ANN/allign_plots.R')
source('~/Desktop/marko_paper/github_code/FederatedLearningViaCoTraining/experiments/open_ml_forex_usd_cad/ANN/allign_plots.R')
setwd("~/Desktop/marko_paper/github_code/FederatedLearningViaCoTraining/experiments/open_ml_forex_usd_cad/RF")
source('~/Desktop/marko_paper/github_code/FederatedLearningViaCoTraining/experiments/open_ml_forex_usd_cad/RF/plot_results.R')
